name: Sync to Downstream Repos

on:
  push:
    branches: [dev]
    paths-ignore:
      - '**.md'
      - '.ai-context/**'
      - '.github/**'
  workflow_dispatch:

permissions:
  contents: read

jobs:
  notify-promps-pro:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Promps-Pro sync
        uses: peter-evans/repository-dispatch@v3
        with:
          token: ${{ secrets.PUBLIC_REPO_TOKEN }}
          repository: BonoJovi/Promps-Pro
          event-type: sync-from-upstream
          client-payload: '{"source": "Promps", "ref": "${{ github.sha }}"}'

      - name: Log dispatch
        run: |
          echo "Dispatched sync-from-upstream to Promps-Pro"
          echo "Source commit: ${{ github.sha }}"
